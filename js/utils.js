HTMLElement.prototype.wrap=function(wrapper){this.parentNode.insertBefore(wrapper,this),this.parentNode.removeChild(this),wrapper.appendChild(this)},NexT.utils={wrapImageWithFancyBox:function(){document.querySelectorAll(".post-body :not(a) > img, .post-body > img").forEach(element=>{var element=$(element),imageLink=element.attr("data-src")||element.attr("src"),imageLink=element.wrap(`<a class="fancybox fancybox.image" href="${imageLink}" itemscope itemtype="http://schema.org/ImageObject" itemprop="url"></a>`).parent("a"),element=(element.is(".post-gallery img")?imageLink.attr("data-fancybox","gallery").attr("rel","gallery"):element.is(".group-picture img")?imageLink.attr("data-fancybox","group").attr("rel","group"):imageLink.attr("data-fancybox","default").attr("rel","default"),element.attr("title")||element.attr("alt"));element&&(imageLink.append(`<p class="image-caption">${element}</p>`),imageLink.attr("title",element).attr("data-caption",element))}),$.fancybox.defaults.hash=!1,$(".fancybox").fancybox({loop:!0,helpers:{overlay:{locked:!1}}})},registerExtURL:function(){document.querySelectorAll("span.exturl").forEach(element=>{var link=document.createElement("a");link.href=decodeURIComponent(atob(element.dataset.url).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")),link.rel="noopener external nofollow noreferrer",link.target="_blank",link.className=element.className,link.title=element.title,link.innerHTML=element.innerHTML,element.parentNode.replaceChild(link,element)})},registerCopyCode:function(){document.querySelectorAll("figure.highlight").forEach(element=>{var box=document.createElement("div"),box=(element.wrap(box),box.classList.add("highlight-container"),box.insertAdjacentHTML("beforeend",'<div class="copy-btn"><i class="fa fa-clipboard fa-fw"></i></div>'),element.parentNode.querySelector(".copy-btn"));box.addEventListener("click",event=>{var event=event.currentTarget,code=[...event.parentNode.querySelectorAll(".code .line")].map(line=>line.innerText).join("\n"),ta=document.createElement("textarea"),selection=(ta.style.top=window.scrollY+"px",ta.style.position="absolute",ta.style.opacity="0",ta.readOnly=!0,ta.value=code,document.body.append(ta),document.getSelection()),selected=0<selection.rangeCount&&selection.getRangeAt(0),code=(ta.select(),ta.setSelectionRange(0,code.length),ta.readOnly=!1,document.execCommand("copy"));CONFIG.copycode.show_result&&(event.querySelector("i").className=code?"fa fa-check fa-fw":"fa fa-times fa-fw"),ta.blur(),event.blur(),selected&&(selection.removeAllRanges(),selection.addRange(selected)),document.body.removeChild(ta)}),box.addEventListener("mouseleave",event=>{setTimeout(()=>{event.target.querySelector("i").className="fa fa-clipboard fa-fw"},300)})})},wrapTableWithBox:function(){document.querySelectorAll("table").forEach(element=>{var box=document.createElement("div");box.className="table-container",element.wrap(box)})},registerVideoIframe:function(){document.querySelectorAll("iframe").forEach(element=>{var box,height;["www.youtube.com","player.vimeo.com","player.youku.com","player.bilibili.com","www.tudou.com"].some(host=>element.src.includes(host))&&!element.parentNode.matches(".video-container")&&((box=document.createElement("div")).className="video-container",element.wrap(box),box=Number(element.width),height=Number(element.height),box)&&height&&(element.parentNode.style.paddingTop=height/box*100+"%")})},registerScrollPercent:function(){var backToTop=document.querySelector(".back-to-top"),readingProgressBar=document.querySelector(".reading-progress-bar");window.addEventListener("scroll",()=>{var docHeight,winHeight;(backToTop||readingProgressBar)&&(docHeight=document.querySelector(".container").offsetHeight,docHeight=(winHeight=window.innerHeight)<docHeight?docHeight-winHeight:document.body.scrollHeight-winHeight,winHeight=Math.min(100*window.scrollY/docHeight,100),backToTop&&(backToTop.classList.toggle("back-to-top-on",50<window.scrollY),backToTop.querySelector("span").innerText=Math.round(winHeight)+"%"),readingProgressBar)&&(readingProgressBar.style.width=winHeight.toFixed(2)+"%")}),backToTop&&backToTop.addEventListener("click",()=>{window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:0})})},registerTabsTag:function(){document.querySelectorAll(".tabs ul.nav-tabs .tab").forEach(element=>{element.addEventListener("click",event=>{event.preventDefault();var event=event.currentTarget;event.classList.contains("active")||([...event.parentNode.children].forEach(element=>{element.classList.remove("active")}),event.classList.add("active"),[...(event=document.getElementById(event.querySelector("a").getAttribute("href").replace("#",""))).parentNode.children].forEach(element=>{element.classList.remove("active")}),event.classList.add("active"),event.dispatchEvent(new Event("tabs:click",{bubbles:!0})))})}),window.dispatchEvent(new Event("tabs:register"))},registerCanIUseTag:function(){window.addEventListener("message",({data})=>{var featureID;"string"==typeof data&&data.includes("ciu_embed")&&(featureID=data.split(":")[1],data=data.split(":")[2],document.querySelector(`iframe[data-feature=${featureID}]`).style.height=parseInt(data,10)+5+"px")},!1)},registerActiveMenuItem:function(){document.querySelectorAll(".menu-item").forEach(element=>{var isSamePath,isSubPath,target=element.querySelector("a[href]");target&&(isSamePath=target.pathname===location.pathname||target.pathname===location.pathname.replace("index.html",""),isSubPath=!CONFIG.root.startsWith(target.pathname)&&location.pathname.startsWith(target.pathname),element.classList.toggle("menu-item-active",target.hostname===location.hostname&&(isSamePath||isSubPath)))})},registerLangSelect:function(){document.querySelectorAll(".lang-select").forEach(sel=>{sel.value=CONFIG.page.lang,sel.addEventListener("change",()=>{let target=sel.options[sel.selectedIndex];document.querySelectorAll(".lang-select-label span").forEach(span=>span.innerText=target.text);var url=target.dataset.href;window.pjax?window.pjax.loadUrl(url):window.location.href=url})})},registerSidebarTOC:function(){let navItems=document.querySelectorAll(".post-toc li"),sections=[...navItems].map(element=>{var element=element.querySelector("a.nav-link"),target=document.getElementById(decodeURI(element.getAttribute("href")).replace("#",""));return element.addEventListener("click",event=>{event.preventDefault();event=target.getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:event+10})}),target});var tocElement=document.querySelector(".post-toc-wrap");!function createIntersectionObserver(marginTop){marginTop=Math.floor(marginTop+1e4);let intersectionObserver=new IntersectionObserver((entries,observe)=>{var scrollHeight=document.documentElement.scrollHeight+100;if(marginTop<scrollHeight)observe.disconnect(),createIntersectionObserver(scrollHeight);else if(observe=(entries=>{let index=0,entry=entries[index];if(0<entry.boundingClientRect.top)return 0===(index=sections.indexOf(entry.target))?0:index-1;for(;index<entries.length;index++){if(!(entries[index].boundingClientRect.top<=0))return sections.indexOf(entry.target);entry=entries[index]}return sections.indexOf(entry.target)})(entries),!(scrollHeight=navItems[observe]).classList.contains("active-current")){document.querySelectorAll(".post-toc .active").forEach(element=>{element.classList.remove("active","active-current")}),scrollHeight.classList.add("active","active-current");for(var parent=scrollHeight.parentNode;!parent.matches(".post-toc");)parent.matches("li")&&parent.classList.add("active"),parent=parent.parentNode;window.anime({targets:tocElement,duration:200,easing:"linear",scrollTop:tocElement.scrollTop-tocElement.offsetHeight/2+scrollHeight.getBoundingClientRect().top-tocElement.getBoundingClientRect().top})}},{rootMargin:marginTop+"px 0px -100% 0px",threshold:0});sections.forEach(element=>{element&&intersectionObserver.observe(element)})}(document.documentElement.scrollHeight)},hasMobileUA:function(){var ua=navigator.userAgent;return/iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g.test(ua)},isTablet:function(){return window.screen.width<992&&767<window.screen.width&&this.hasMobileUA()},isMobile:function(){return window.screen.width<767&&this.hasMobileUA()},isDesktop:function(){return!this.isTablet()&&!this.isMobile()},supportsPDFs:function(){var ua=navigator.userAgent,isFirefoxWithPDFJS=ua.includes("irefox")&&18<parseInt(ua.split("rv:")[1].split(".")[0],10),supportsPdfMimeType=void 0!==navigator.mimeTypes["application/pdf"],ua=/iphone|ipad|ipod/i.test(ua.toLowerCase());return isFirefoxWithPDFJS||supportsPdfMimeType&&!ua},initSidebarDimension:function(){var sidebarNav=document.querySelector(".sidebar-nav"),sidebarNav="none"!==sidebarNav.style.display?sidebarNav.offsetHeight:0,sidebarOffset=CONFIG.sidebar.offset||12,sidebarb2tHeight=CONFIG.back2top.enable&&CONFIG.back2top.sidebar?document.querySelector(".back-to-top").offsetHeight:0,sidebarNav=2*CONFIG.sidebar.padding+sidebarNav+sidebarb2tHeight,sidebarb2tHeight=("Pisces"!==CONFIG.scheme&&"Gemini"!==CONFIG.scheme||(sidebarNav+=2*sidebarOffset-22),document.body.offsetHeight-sidebarNav+"px");document.querySelector(".site-overview-wrap").style.maxHeight=sidebarb2tHeight,document.querySelector(".post-toc-wrap").style.maxHeight=sidebarb2tHeight},updateSidebarPosition:function(){var sidebarNav=document.querySelector(".sidebar-nav"),hasTOC=document.querySelector(".post-toc");(hasTOC?(sidebarNav.style.display="",sidebarNav.classList.add("motion-element"),document.querySelector(".sidebar-nav-toc")):(sidebarNav.style.display="none",sidebarNav.classList.remove("motion-element"),document.querySelector(".sidebar-nav-overview"))).click(),NexT.utils.initSidebarDimension(),this.isDesktop()&&"Pisces"!==CONFIG.scheme&&"Gemini"!==CONFIG.scheme&&(sidebarNav="boolean"!=typeof(sidebarNav=CONFIG.page.sidebar)?"always"===CONFIG.sidebar.display||"post"===CONFIG.sidebar.display&&hasTOC:sidebarNav)&&window.dispatchEvent(new Event("sidebar:show"))},getScript:function(url,callback,condition){var script;condition?callback():((script=document.createElement("script")).onload=script.onreadystatechange=function(_,isAbort){!isAbort&&script.readyState&&!/loaded|complete/.test(script.readyState)||(script.onload=script.onreadystatechange=null,script=void 0,isAbort)||!callback||setTimeout(callback,0)},script.src=url,document.head.appendChild(script))},loadComments:function(element,callback){var intersectionObserver;if(CONFIG.comments.lazyload&&element)return(intersectionObserver=new IntersectionObserver((entries,observer)=>{entries[0].isIntersecting&&(callback(),observer.disconnect())})).observe(element),intersectionObserver;callback()}};